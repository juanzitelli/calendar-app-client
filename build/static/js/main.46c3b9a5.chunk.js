(this["webpackJsonpcalendar-app"]=this["webpackJsonpcalendar-app"]||[]).push([[0],{114:function(e,t,n){},116:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(7),o=n.n(c),l=n(62),s=n(26),i=n(54),u=n(4),m={uiOpenModal:"[UI] Open modal",uiCloseModal:"[UI] Close modal",eventAddNew:"[Events] Add new event",eventStartAddNew:"[Events] Start add new event",eventStartUpdating:"[Events] Start event update",eventUpdated:"[Events] Event updated",eventDeleted:"[Events] Event deleted",eventLogout:"[Events] Event logout",eventSetActive:"[Events] Set active",eventClearActiveEvent:"[Events] Clear active event",eventsLoaded:"[Events] Events loaded",authChecking:"[Auth] Checking login state",authCheckingFinished:"[Auth] Finished checking login state",authStartLogin:"[Auth] Start login",authLogin:"[Auth] Login",authLogout:"[Auth] Start logout",authStartRegister:"[Auth] Start register",authRegister:"[Auth] Register",authStartTokenRenew:"[Auth] Start token renewal"},d={events:[],activeEvent:null},v={modalOpen:!1},p={checking:!0},f=Object(s.combineReducers)({ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m.uiOpenModal:return Object(u.a)(Object(u.a)({},e),{},{modalOpen:!0});case m.uiCloseModal:return Object(u.a)(Object(u.a)({},e),{},{modalOpen:!1});default:return e}},calendar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m.eventSetActive:return Object(u.a)(Object(u.a)({},e),{},{activeEvent:t.payload});case m.eventAddNew:return Object(u.a)(Object(u.a)({},e),{},{events:[].concat(Object(i.a)(e.events),[t.payload])});case m.eventClearActiveEvent:return Object(u.a)(Object(u.a)({},e),{},{activeEvent:null});case m.eventUpdate:return Object(u.a)(Object(u.a)({},e),{},{events:e.events.map((function(e){return e.id===t.payload.id?t.payload:e}))});case m.eventDeleted:return Object(u.a)(Object(u.a)({},e),{},{events:e.events.filter((function(t){return t.id!==e.activeEvent.id})),activeEvent:null});case m.eventsLoaded:return Object(u.a)(Object(u.a)({},e),{},{events:Object(i.a)(t.payload)});case m.eventLogout:return Object(u.a)({},d);default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m.authLogin:return Object(u.a)(Object(u.a)(Object(u.a)({},e),t.payload),{},{checking:!1});case m.authCheckingFinished:return Object(u.a)(Object(u.a)({},e),{},{checking:!1});case m.authLogout:return{checking:!1};default:return e}}}),E=n(26),b=E.createStore,h=E.applyMiddleware,g=E.compose,O=b(f,("undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||g)(h(l.a))),j=n(8),w=n(35),y=n(9),N=n(11),k=n.n(N),S=n(18),x=n(17),C=n.n(x),A="https://mern-calendar-zitelli.herokuapp.com/api",D=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",a="".concat(A,"/").concat(e);return"GET"===n?fetch(a):fetch(a,{method:n,headers:{"Content-type":"application/json"},body:JSON.stringify(t)})},L=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",a="".concat(A,"/").concat(e),r=localStorage.getItem("x-token")||"";return"GET"===n?fetch(a,{method:n,headers:{"x-token":r}}):fetch(a,{method:n,headers:{"Content-type":"application/json","x-token":r},body:JSON.stringify(t)})},P=function(e){return{type:m.authLogin,payload:e}},T=function(){return{type:m.authCheckingFinished}},I=function(){return{type:m.authLogout}},R=n(13),M=n(23),_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(a.useState)(e),n=Object(R.a)(t,2),r=n[0],c=n[1],o=function(){c(e)},l=function(e){var t=e.target;c(Object(u.a)(Object(u.a)({},r),{},Object(M.a)({},t.name,t.value)))};return[r,l,o]},U=(n(75),function(){var e=Object(j.b)(),t=_({loginEmail:"",loginPassword:""}),n=Object(R.a)(t,2),a=n[0],c=n[1],o=a.loginEmail,l=a.loginPassword,s=_({registerName:"",registerEmail:"",registerPassword1:"",registerPassword2:""}),i=Object(R.a)(s,2),u=i[0],m=i[1],d=u.registerName,v=u.registerEmail,p=u.registerPassword1,f=u.registerPassword2;return r.a.createElement("div",{className:"container login-container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6 login-form-1"},r.a.createElement("h3",null,"Sign In"),r.a.createElement("form",{onSubmit:function(t){var n,a;t.preventDefault(),e((n=o,a=l,function(){var e=Object(S.a)(k.a.mark((function e(t){var r,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("auth",{email:n,password:a},"POST");case 2:return r=e.sent,e.next=5,r.json();case 5:(c=e.sent).ok?(localStorage.setItem("x-token",c.token),localStorage.setItem("token-init-date",(new Date).getTime()),t(P({uid:c.uid,name:c.name}))):C.a.fire("Error",c.msg,"error");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Email",name:"loginEmail",value:o,onChange:c})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",className:"form-control",placeholder:"Password",name:"loginPassword",value:l,onChange:c})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"submit",className:"btnSubmit",value:"Login"})))),r.a.createElement("div",{className:"col-md-6 login-form-2"},r.a.createElement("h3",null,"Register"),r.a.createElement("form",{onSubmit:function(t){if(t.preventDefault(),p!==f)return C.a.fire("Error","Passwords should match","error");var n,a,r;e((n=v,a=p,r=d,function(){var e=Object(S.a)(k.a.mark((function e(t){var c,o;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("auth/new",{email:n,password:a,name:r},"POST");case 2:return c=e.sent,e.next=5,c.json();case 5:(o=e.sent).ok?(localStorage.setItem("x-token",o.token),localStorage.setItem("token-init-date",(new Date).getTime()),t(P({uid:o.uid,name:o.name}))):C.a.fire("Error",o.msg,"error");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Name",name:"registerName",value:d,onChange:m})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"email",className:"form-control",placeholder:"Email",name:"registerEmail",value:v,onChange:m})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",className:"form-control",placeholder:"Password",name:"registerPassword1",value:p,onChange:m})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",className:"form-control",placeholder:"Repeat your password",name:"registerPassword2",value:f,onChange:m})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"submit",className:"btnSubmit",value:"Create account"}))))))}),G=n(15),F=n.n(G),J=(n(77),n(53)),V=(n(78),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{end:F()(e.end).toDate(),start:F()(e.start).toDate()})}))}),H=function(e){return{type:m.eventAddNew,payload:e}},z=function(){return{type:m.eventClearActiveEvent}},X=function(e){return{type:m.eventUpdated,payload:e}},q=function(){return{type:m.eventDeleted}},B=function(e){return{type:m.eventsLoaded,payload:e}},K=function(){return{type:m.uiOpenModal}},Q=function(){var e=Object(j.b)();return r.a.createElement("button",{className:"btn btn-primary fab",onClick:function(){e(K())}},r.a.createElement("i",{className:"fas fa-plus"}))},W=function(){var e=Object(j.b)();return r.a.createElement("button",{className:"btn btn-danger fab-danger",onClick:function(){e(function(){var e=Object(S.a)(k.a.mark((function e(t,n){var a,r,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n().calendar.activeEvent.id,e.prev=1,e.next=4,L("events/".concat(a),{},"DELETE");case 4:return r=e.sent,e.next=7,r.json();case 7:(c=e.sent).ok?t(q()):C.a.fire("Error",c.msg,"error"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}())}},r.a.createElement("i",{className:"fas fa-trash"}),r.a.createElement("span",null," Delete event"))},Y=function(){var e=Object(j.c)((function(e){return e.auth})).name,t=Object(j.b)();return r.a.createElement("div",{className:"navbar navbar-dark bg-dark"},r.a.createElement("span",{className:"navbar-brand"},e,"'s calendar \ud83d\udcc5"),r.a.createElement("button",{className:"btn btn-outline-danger"},r.a.createElement("span",{onClick:function(){t(function(){var e=Object(S.a)(k.a.mark((function e(t){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.clear(),t(I());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t({type:m.eventLogout})}},r.a.createElement("i",{className:"fas fa-sign-out-alt"})," Exit")))},Z=function(e){var t=e.event,n=t.title,a=t.user;return r.a.createElement("div",null,r.a.createElement("span",null,n," ",r.a.createElement("strong",null,"- ",a.name)))},$=n(48),ee=n.n($),te=n(50),ne=n.n(te),ae={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};ne.a.setAppElement("#root");var re=F()().minutes(0).second(0).add(1,"hours"),ce=re.clone().add(1,"hours"),oe={title:"",notes:"",start:re.toDate(),end:ce.toDate()},le=function(){var e=Object(a.useState)(re.toDate()),t=Object(R.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(ce.toDate()),l=Object(R.a)(o,2),s=l[0],i=l[1],d=Object(a.useState)(!0),v=Object(R.a)(d,2),p=v[0],f=v[1],E=Object(a.useState)(oe),b=Object(R.a)(E,2),h=b[0],g=b[1],O=Object(j.b)(),w=Object(j.c)((function(e){return e.ui})).modalOpen,y=Object(j.c)((function(e){return e.calendar})).activeEvent,N=h.notes,x=h.title,A=h.start,D=h.end,P=function(e){var t=e.target;g(Object(u.a)(Object(u.a)({},h),{},Object(M.a)({},t.name,t.value)))},T=function(){O({type:m.uiCloseModal}),O(z()),g(oe)};return Object(a.useEffect)((function(){g(y||oe)}),[y]),r.a.createElement(ne.a,{isOpen:w,onRequestClose:T,closeTimeoutMS:300,style:ae,className:"modal",overlayClassName:"modal-fondo",ariaHideApp:!1},r.a.createElement("h1",null," ",y?"Edit event":"New event"," "),r.a.createElement("hr",null),r.a.createElement("form",{className:"container",onSubmit:function(e){e.preventDefault();var t=F()(A),n=F()(D);return t.isSameOrAfter(n)?C.a.fire("Error","End date shouldn't be lower than start date","error"):x.trim().length<2?f(!1):(f(!0),O(y?function(e){return function(){var t=Object(S.a)(k.a.mark((function t(n){var a,r;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L("events/".concat(e.id),e,"PUT");case 3:return a=t.sent,t.next=6,a.json();case 6:(r=t.sent).ok?n(X(e)):C.a.fire("Error",r.msg,"error"),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.error(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()}(h):function(e){return function(){var t=Object(S.a)(k.a.mark((function t(n,a){var r,c,o,l,s;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a().auth,c=r.uid,o=r.name,t.prev=1,t.next=4,L("events",e,"POST");case 4:return l=t.sent,t.next=7,l.json();case 7:(s=t.sent).ok&&(e.id=s.evento.id,e.user={_id:c,name:o},n(H(e))),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e,n){return t.apply(this,arguments)}}()}(h)),void T())}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Start date and time"),r.a.createElement(ee.a,{onChange:function(e){c(e),g(Object(u.a)(Object(u.a)({},h),{},{start:e}))},value:n,className:"form-control",name:"start"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"End date and time"),r.a.createElement(ee.a,{onChange:function(e){i(e),g(Object(u.a)(Object(u.a)({},h),{},{end:e}))},value:s,minDate:n,className:"form-control",name:"end"})),r.a.createElement("hr",null),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Title and notes"),r.a.createElement("input",{type:"text",className:"form-control ".concat(!p&&"is-invalid"),placeholder:"Event's title",name:"title",autoComplete:"off",value:x,onChange:P}),r.a.createElement("small",{id:"emailHelp",className:"form-text text-muted"},"A short description")),r.a.createElement("div",{className:"form-group"},r.a.createElement("textarea",{type:"text",className:"form-control",placeholder:"Notes",rows:"5",name:"notes",value:N,onChange:P}),r.a.createElement("small",{id:"emailHelp",className:"form-text text-muted"},"Additional information")),r.a.createElement("button",{type:"submit",className:"btn btn-outline-primary btn-block"},r.a.createElement("i",{className:"far fa-save"}),r.a.createElement("span",null," Save"))))};F.a.locale("en");var se=Object(J.b)(F.a),ie=function(){var e=Object(j.b)(),t=Object(j.c)((function(e){return e.calendar})),n=t.events,c=t.activeEvent,o=Object(a.useState)(localStorage.getItem("lastView")||"month"),l=Object(R.a)(o,2),s=l[0],i=l[1],u=Object(j.c)((function(e){return e.auth})).uid;return Object(a.useEffect)((function(){e(function(){var e=Object(S.a)(k.a.mark((function e(t){var n,a,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L("events");case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,r=a.eventos,t(B(V(r))),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}())}),[e]),r.a.createElement("div",{className:"calendar-screen"},r.a.createElement(Y,null),r.a.createElement(J.a,{localizer:se,events:n,startAccessor:"start",endAccessor:"end",eventPropGetter:function(e){return{style:{backgroundColor:e.user._id===u?"#367cf7":"#465660",opacity:.8,display:"block",color:"white"}}},components:{event:Z},onDoubleClickEvent:function(t){e(K())},onSelectEvent:function(t){e({type:m.eventSetActive,payload:t})},onView:function(e){i(e),localStorage.setItem("lastView",e)},view:s,selectable:!0,onSelectSlot:function(){e(z())}}),r.a.createElement(Q,null),c&&r.a.createElement(W,null),r.a.createElement(le,null))},ue=n(39),me=function(e){var t=e.isAuthenticated,n=e.component,a=Object(ue.a)(e,["isAuthenticated","component"]);return r.a.createElement(y.b,Object.assign({},a,{component:function(e){return t?r.a.createElement(n,e):r.a.createElement(y.a,{to:"/login"})}}))},de=function(e){var t=e.isAuthenticated,n=e.component,a=Object(ue.a)(e,["isAuthenticated","component"]);return r.a.createElement(y.b,Object.assign({},a,{component:function(e){return t?r.a.createElement(y.a,{to:"/"}):r.a.createElement(n,e)}}))},ve=function(){var e=Object(j.b)(),t=Object(j.c)((function(e){return e.auth})),n=t.checking,c=t.uid;return Object(a.useEffect)((function(){e(function(){var e=Object(S.a)(k.a.mark((function e(t){var n,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L("auth/renew");case 2:return n=e.sent,e.next=5,n.json();case 5:(a=e.sent).ok?(localStorage.setItem("x-token",a.token),localStorage.setItem("token-init-date",(new Date).getTime()),t(P({uid:a.uid,name:a.name}))):t(T());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]),n?r.a.createElement("h5",null,"Loading..."):r.a.createElement(w.a,null,r.a.createElement("div",null,r.a.createElement(y.d,null,r.a.createElement(de,{isAuthenticated:!!c,exact:!0,path:"/login",component:U}),r.a.createElement(me,{isAuthenticated:!!c,exact:!0,path:"/",component:ie}),r.a.createElement(y.a,{to:"/"}))))},pe=function(){return r.a.createElement(j.a,{store:O},r.a.createElement(ve,null))};n(114);o.a.render(r.a.createElement(pe,null),document.getElementById("root"))},66:function(e,t,n){e.exports=n(116)},75:function(e,t,n){}},[[66,1,2]]]);
//# sourceMappingURL=main.46c3b9a5.chunk.js.map